---
title: "Analysis of Guinea Pig Tooth Growth Using R"
author: "Kevin E. D'Elia"
date: "March 5, 2016"
output: pdf_document
---

# Synopsis of Analysis
In this paper, the techniques of Exploratory Data Analysis (EDA) will be applied to the dataset __ToothGrowth__.  Among those techniques are the use of tabular (_summary()_, _str()_) as well as graphical (_histogram()_, _boxplot()_) representations of the data in order to glean patterns and structure within the data.  The analysis will attempt to answer the following question:  Is the data in this dataset normally distributed and, by extension, if not, then why not?

# Summary of the data
Usually the first step in any analysis is to acquire and load the data.  In this case, however, the dataset is preloaded in __R__ and is available via the __datasets__ package.  So, simply typing __ToothGrowth__ at the console prompt will display the full dataset.  The first few lines look like this:
```{r display_head}
head(ToothGrowth)
```
A bit of background on this dataset:  from the R documentation - _The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, (orange juice or ascorbic acid (a form of vitamin C and coded as VC)._

The structure of this dataset, as described by the documentation, is displayed using the following R command:
```{r structure}
str(ToothGrowth)
```

This table confirms that the dataset consists of 60 observations of 3 variables.  Again, from the R documentation: 
_A data frame with 60 observations on 3 variables._

_[,1]	 len	 numeric	 Tooth length_

_[,2]	 supp	 factor	 Supplement type (VC or OJ)._

_[,3]	 dose	 numeric	 Dose in milligrams/day_

Since the second variable is a _factor_, or _grouping_, variable, and the third variable has values in a fixed range from 0.5:2 (and thus not very interesting from an analytical perspective), the next step in the analysis will exclude those two columns and look only at changes in tooth length.  To see a basic summary of the measures of central tendency for the ToothGrowth growth length variable, use the eponymous R command:
```{r summarize}
summary(ToothGrowth["len"])
```

Other important descriptive statistics, which are absent from the base _summary()_ function, are __skew__ and __kurtosis__.  Skew is an indication of which way the data is skewed, positively or negatively, while kurtosis describes the curvature of the shape of the curve (more bell-shaped or less so).  While functions to provide these statistics are available in several R packages, such as __pastecs__ and __psych__, it is a relatively simple matter to write some R code which calculates these statistics.  First, though, it is good practice to handle possible missing data (NA values) in the dataset.
```{r check_for_NA}
sum(is.na(ToothGrowth))
```

The _is.na()_ function returns a logical vector which is numerically represented as 0 for FALSE and 1 for TRUE.  Taking the sum of that vector and getting a non-zero result indicates the presence of NA values.  In this case, however, the result is 0, so the dataset is completely populated with meaningful values.  Skew and kurtosis can now be computed.

```{r skew_and_kurtosis}
other.stats <- function(x) {
  m <- mean(x)
  n <- length(x)
  s <- sd(x)
  skew <- round(sum( (x - m)^3 / s^3 ) / n, 3)
  kurtosis <- round(sum( (x - m)^4 / s^4 ) / n - 3, 3)
  return(c(skew=skew, kurtosis=kurtosis))
}
sapply(ToothGrowth["len"], other.stats)
```
What do these statistics tell us about the data?  The mean is slightly lower than the mean, so that indicates a small left-skewing of the data.  The value for the skew is negative, which supports that assessment.  The kurtosis is also slightly negative, indicating a curve that is minimally flatter than a standard bell curve.
```{r}
require(graphics)
coplot(len ~ dose | supp, data = ToothGrowth, panel = panel.smooth, xlab = "ToothGrowth data: length vs dose, given type of supplement")
plot(ToothGrowth$len ~ ToothGrowth$dose)
reg <- lm(ToothGrowth$len ~ ToothGrowth$dose)
abline(reg)
oldpar <- par(mfrow = c(2, 2), oma = c(0, 0, 2, 0) + 0.1)
growth <- ToothGrowth$len
hist(growth)
plot(density(growth), lwd = 1, main = "Kernel Density Estimation")
rug(growth)
qqnorm(growth)
qqline(growth)
boxplot(len ~ dose, data = ToothGrowth)
mtext("Graphical Exploratory Data Analysis of Guinea Pig Tooth Growth Data", font = 4, outer = TRUE)
par(oldpar)
rm(oldpar)
```

### ---- Next area of focus

1. There are no outliers

Document outlines key assumptions made about the analysis such as whether the variables are normally distributed, and how this affects the choice of statistical methods used for the analysis

### --- Confidence intervals
document uses confidence intervals and/or hypothesis tests to compare tooth growth by dose and supp (Delivery Method)

##  -- Results
Results of the confidence intervals / hypothesis tests are interpreted correctly, given the context of the problem.

## -- Answers
document provides an answer to the question, "Do Delivery methods and/or dosage affect tooth growth in guinea pigs?"